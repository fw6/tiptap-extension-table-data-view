<script lang="ts">
    import type { FieldConfig } from "../types"

    export let visible = false;
    export let fieldConfig: FieldConfig

    let activeOptionIndex = -1;
    let fieldType = fieldConfig.type;
    let fieldName = fieldConfig.fieldName;

    $: {
        if (!visible) activeOptionIndex = -1;
    }
    $: {
        fieldType = fieldConfig.type;
        fieldName = fieldConfig.fieldName
    }

    const options = [
        {
            index: 0,
            icon: 'ğŸ˜¶â€ğŸŒ«ï¸',
            text: 'ä¿®æ”¹å­—æ®µåˆ—',
        },
        {
            index: 1,
            icon: 'ğŸ˜µâ€ğŸ’«',
            text: 'ç¼–è¾‘å­—æ®µåˆ—æè¿°',
        },
        {
            index: 2,
            icon: 'ğŸ˜¢',
            text: 'å¤åˆ¶å­—æ®µ/åˆ—',
        },
        {
            index: 3,
            icon: 'ğŸ¤£',
            text: 'å‘å³æ’å…¥å­—æ®µ/åˆ—',
        },
        {
            index: 4,
            icon: 'ğŸ¤£',
            text: 'å†»ç»“è‡³æ­¤å­—æ®µ/åˆ—',
        },
    ];
</script>

{#if visible}
    <div class="field-options">
        {#if activeOptionIndex < 0}
            {#each options as opt(opt.index)}
                <div class="option" on:mousedown={() => activeOptionIndex = opt.index}>{opt.icon}{opt.text}</div>
            {/each}
        {:else}
            <div class="option-settings">
                {activeOptionIndex}
                {#if activeOptionIndex === 0}
                    <label>
                        <span>æ ‡é¢˜</span>
                        <input type="text" bind:value={fieldName} >
                    </label>

                    <label>
                        <span>å­—æ®µç±»å‹</span>
                        <select bind:value={fieldType}>
                            <option value="1">å¤šè¡Œæ–‡æœ¬</option>
                            <option value="2">æ•°å­—</option>
                            <option value="3">å•é€‰</option>
                            <option value="4">å¤šé€‰</option>
                            <option value="5">æ—¥æœŸ</option>
                            <option value="6">å¤é€‰æ¡†</option>
                            <option value="7">äººå‘˜</option>
                            <option value="8">ç”µè¯å·ç </option>
                        </select>
                    </label>
                {/if}

                <p class="btns">
                    <button>ç¡®å®šâœ…</button>
                    <button>å–æ¶ˆ</button>
                </p>
            </div>
        {/if}
    </div>
{/if}

<style lang="postcss">
    .field-options {
        position: absolute;
        left: 0;
        top: 100%;
        width: 100%;
        background-color: white;
        box-shadow: 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05);
        z-index: 9;
    }
</style>
